{
  "hash": "26a1047267a9eda9f235ede4eacb7963",
  "result": {
    "markdown": "---\ntitle: \"Project Oriented Workflows\"\nsubtitle: \"Working in R and RStudio\"\nauthor: \"Athanasia Mo Mowinckel\"\n#logo: \"img/wtf-logo-square-transparent.png\"\nformat: \n  revealjs: \n    height: 900\n    width: 1600\n    theme: \n      - night\n      - capro-reveal.scss\n    highlight-style: github-dark\n    transition: fade\n    slide-number: true\n    chalkboard: true\neditor: visual\nexecute:\n  freeze: auto\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n# Project-oriented workflows\n\n## Adopt a project-oriented workflow\n\n<br>\n\n::: columns\n::: {.column width=\"48%\"}\n### Why\n\n-   work on more than 1 thing at a time\n\n-   collaborate, communicate, distribute\n\n-   start and stop\n:::\n\n::: {.column width=\"4%\"}\n:::\n\n::: {.column .fragment width=\"48%\"}\n### How\n\n-   dedicated directory\n\n-   RStudio <ins>**P**</ins>roject\n\n-   Git repo, probably syncing to a remote\n:::\n:::\n\n## Project workflows\n\n-   All necessary files contained in the project and referenced relatively\n\n-   All necessary outputs are created by code in the project\n\n-   All code can be run in fresh sessions and produce the same output\n\n-   Does not force other users to alter their own work setup\n\n## If the top of your script is\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetwd(\"C:\\Users\\jenny\\path\\that\\only\\I\\have\")\nrm(list = ls())\n```\n:::\n\n\n<br>\n\nJenny will come into your your office and SET YOUR COMPUTER ON FIRE ðŸ”¥.\n\n<br>\n\n::: {.fragment fragment-index=\"1\"}\nProject-oriented workflow designs this away. ðŸ™Œ\n:::\n\n::: footer\n<https://twitter.com/hadleywickham/status/940021008764846080>\n\n<https://www.tidyverse.org/articles/2017/12/workflow-vs-script/>\n\n<https://rstats.wtf/project-oriented-workflow.html>\n:::\n\n## Which persist after rm(list = ls())?\n\n| Option                               | Persists? |\n|--------------------------------------|-----------|\n| A. library(dplyr)                    |           |\n| B. summary \\<- head                  |           |\n| C. options(stringsAsFactors = FALSE) |           |\n| D. Sys.setenv(LANGUAGE = \"fr\")       |           |\n| E. x \\<- 1:5                         |           |\n| F. attach(iris)                      |           |\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_e72b9890\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n## Which persist after rm(list = ls())?\n\n| Option                               | Persists?                                    |\n|--------------------------------------|----------------------------------------------|\n| A. library(dplyr)                    | `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#CC4C4C;overflow:visible;position:relative;\"><path d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"/></svg>`{=html} |\n| B. summary \\<- head                  | `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 384 512\" style=\"height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;\"><path d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"/></svg>`{=html} |\n| C. options(stringsAsFactors = FALSE) | `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#CC4C4C;overflow:visible;position:relative;\"><path d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"/></svg>`{=html} |\n| D. Sys.setenv(LANGUAGE = \"fr\")       | `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#CC4C4C;overflow:visible;position:relative;\"><path d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"/></svg>`{=html} |\n| E. x \\<- 1:5                         | `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 384 512\" style=\"height:1em;width:0.75em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;\"><path d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"/></svg>`{=html} |\n| F. attach(iris)                      | `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#CC4C4C;overflow:visible;position:relative;\"><path d=\"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"/></svg>`{=html} |\n\n## What does it mean to be an RStudio <ins>**P**</ins>roject?\n\n<br>\n\nRStudio leaves notes to itself in foo.Rproj\n\n. . .\n\n<br>\n\nOpen Project = dedicated instance of RStudio\n\n-   dedicated R process\n\n-   file browser pointed at Project directory\n\n-   working directory set to Project directory\n\n## Many projects open\n\n<br>\n\n![](img/many-projects.jpg)\n\n## Use a \"blank slate\"\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::use_blank_slate()\n```\n:::\n\n\n<br>\n\nOR\n\n<br>\n\nTools -\\> Global Options\n\n![](img/workspace.PNG)\n\n## Restart R often\n\n<br>\n\n::: columns\n::: {.column width=\"48%\"}\nSession -\\> Restart R\n\n![](img/restart.jpg)\n:::\n\n::: {.column width=\"4%\"}\n:::\n\n::: {.column width=\"48%\"}\nWindows\n\n-   Ctrl + Shift + F10\n\nMac\n\n-   Cmd + Shift + 0\n\n-   Cmd + Shift + F10\n:::\n:::\n\n## Project initiation: the local case\n\n1.  New folder + make it an RStudio Project\n\n-   `usethis::create_project(\"~/i_am_new\")`\n\n-   File -\\> New Project -\\> New Directory -\\> New Project\n\n. . .\n\n2.  Make existing folder into an RStudio Project\n\n-   `usethis::create_project(\"~/i_exist\")`\n\n-   File -\\> New Project -\\> Existing Directory\n\n. . .\n\n::: question\nTry option 2 now for wtf-explore-libraries.\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_3fb3fb5d\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n# Safe paths\n\n##  {background-image=\"img/deep_thoughts.PNG\"}\n\n## On reproducibility of code\n\n::: columns\n::: {.column width=\"50%\"}\n![](img/kieran-healy-setwd.PNG)\n:::\n\n::: {.column width=\"4%\"}\n:::\n\n::: {.column width=\"46%\"}\n<br> A large-scale study on research code quality and execution. <br> Trisovic, A., Lau, M.K., Pasquier, T. et al. <br> *Sci Data* **9**, 60 (2022).\n:::\n:::\n\n::: footer\n<https://twitter.com/kjhealy/status/1514169782060429320> <br> <https://doi.org/10.1038/s41597-022-01143-6>\n:::\n\n## Do you know where<br> your files are?\n\n![](img/street-sign.png)\n\n::: notes\nWorking directory is associated with a specific process or running application.\n\nFor a newly launched process or application instance, the working directory (probably? usually?) defaults to user's home directory. Or perhaps the application consults a config file to set the working directory at launch time. This is sort of how I would describe launching an RStudio Project.\n\n\"Working directory\" as a concept is not comparable to \"home directory\". \"Home directory\" is a static, persistent thing.\n:::\n\n## Practice \"safe paths\"\n\n<br>\n\nrelative to a [stable base]{.important}\n\n<br>\n\nuse [file system functions]{.important}\n\nÂ  Â  not `paste()`, `strsplit()`, etc.\n\n## Packages with file system functions\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"fs\")\n```\n:::\n\n\n`fs` = file path handling\n\n<br>\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"here\")\n```\n:::\n\n\n`here` = project-relative paths\n\n## Examples of a stable base\n\n<brshort>\n\nProject directory\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhere::here(\"data\", \"raw-data.csv\")\nhere::here(\"data/raw-data.csv\")\n```\n:::\n\n\n*Automatically complete paths with `Tab`.*\n\n<brshort>\n\n. . .\n\nUser's home directory\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfile.path(\"~\", ...)\nfs::path_home(...)\n```\n:::\n\n\n. . .\n\n<brshort>\n\nOfficial location for installed software\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(thingy)\nsystem.file(..., package = \"thingy\")\n```\n:::\n\n\n*See example in [gapminder readme](https://github.com/jennybc/gapminder#plain-text-delimited-files).*\n\n::: notes\nsee where tilde goes with fs::path_expand(file.path(\"\\~\"))\n:::\n\n## Absolute paths\n\nI have nothing against absolute paths.\n\nSome of my best friends are absolute paths!\n\nBut don't hard-wire them into your scripts.\n\nInstead, form at runtime relative to a [stable base]{.important}\n\n<brshort>\n\n\n::: {.cell}\n\n```{.r .cell-code}\n> (BAD <- \"/Users/shannon/tmp/test.csv\")\n[1] \"/Users/shannon/tmp/test.csv\"\n```\n:::\n\n\n. . .\n\n<brshort>\n\n\n::: {.cell}\n\n```{.r .cell-code}\n> (GOOD <- fs::path_home(\"tmp/test.csv\")\n[1] \"/Users/shannon/tmp/test.csv\"\n```\n:::\n\n\n## Practice safe paths\n\n::: columns\n::: {.column width=\"50%\"}\n![](img/here.png)\n:::\n\n::: {.column width=\"4%\"}\n:::\n\n::: {.column .fragment width=\"46%\"}\n-   Use the `here` package to build paths inside a project.\n\n-   Leave working directory at top-level at all times, during development.\n\n-   Absolute paths are formed at runtime.\n:::\n:::\n\n::: footer\nArtwork by [\\@allison_horst](https://twitter.com/allison_horst).\n:::\n\n## here example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(here::here(\"figs\", \"built-barchart.png\"))\n```\n:::\n\n\n-   Works on my machine, works on yours!\n\n-   Works even if working directory is in a sub-folder.\n\n-   Works for RStudio <ins>**P**</ins>rojects, Git repos, R packages, etc.\n\n-   Works with knitr / rmarkdown.\n\n## here::here()\n\nThe `here` package is designed to work inside a project, where that could mean:\n\n-   RStudio <ins>**P**</ins>roject\n\n-   Git repo\n\n-   R package\n\n-   Folder with a file named .here\n\n`here::here()` does not create directories; that's your job.\n\n## Kinds of paths\n\nAbsolute path.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- read.csv(\"C:/Users/pileggis/Documents/wtf-fix-paths/data/installed-packages.csv\")\n```\n:::\n\n\n<br>\n\nRelative path to working directory, established by the RStudio <ins>**P**</ins>roject.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- read.csv(\"data/installed-packages.csv\")\n```\n:::\n\n\n<br>\n\nRelative path within the RStudio <ins>**P**</ins>roject directory.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- read.csv(here::here(\"data/installed-packages.csv\"))\n```\n:::\n\n\n## Your turn\n\n<br>\n\nPractice calling `here::here()` in a project <br> to get a feel for it.\n\n<br>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(usethis)\n# saves project on desktop by default for most users\nuse_course(\"rstats-wtf/wtf-fix-paths\")\n# use_course(\"rstats-wtf/wtf-fix-paths\", destdir = \"my/new/location\")\n# can alternatively download from \n# https://github.com/rstats-wtf/wtf-fix-paths\n```\n:::\n\n\n<br> Read the `README.md` to get started.\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_937e249a\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">15</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n## What if my data can't live in my project directory? {.smaller}\n\n1.  Are you sure it can't?\n\n2.  Review the Good Enough Practices paper for tips.\n\n3.  Create a symbolic link to access the data. ([fs::link_create()](https://fs.r-lib.org/reference/create.html), [fs::link_path()](https://fs.r-lib.org/reference/create.html))\n\n4.  Put the data in an [R package](https://r-pkgs.org/data.html).\n\n5.  Use [pins](https://pins.rstudio.com/).\n\n6.  Explore other data warehousing options.\n\nRStudio Community threads:\n\n-   [Project-oriented workflow; setwd(), rm(list = ls()) and computer fires](https://community.rstudio.com/t/project-oriented-workflow-setwd-rm-list-ls-and-computer-fires/3549/1)\n\n-   [Best way to define paths for a file running on a cron?](https://community.rstudio.com/t/best-way-to-define-paths-for-a-file-running-on-a-cron/2061/7)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}